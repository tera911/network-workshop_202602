# Day 2: スタティックルーティング - 演習用トポロジ（穴あき版）
#
# 【演習】
# 3拠点（本社・東京・大阪）間で通信できるように
# 各ルーターにスタティックルートを設定してください。
#
# 構成（3拠点）:
#
#         [host-hq]
#             |
#         [router-hq]
#          /        \
#   [router-osaka]  [router-tokyo]
#        |               |
#   [host-osaka]    [host-tokyo]
#
# ネットワーク設計:
#   HQ LAN:           10.0.0.0/24
#   Tokyo LAN:        10.1.0.0/24
#   Osaka LAN:        10.2.0.0/24
#   HQ - Tokyo:       172.16.1.0/24
#   HQ - Osaka:       172.16.2.0/24

name: day2-exercise

topology:
  nodes:
    # === 本社（HQ）===
    router-hq:
      kind: linux
      image: ghcr.io/vyos/vyos:current
      # 演習: スタティックルートを設定

    host-hq:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 10.0.0.10/24 dev eth1
        - ip route add default via 10.0.0.1

    # === 東京拠点 ===
    router-tokyo:
      kind: linux
      image: ghcr.io/vyos/vyos:current
      # 演習: スタティックルートを設定

    host-tokyo:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 10.1.0.10/24 dev eth1
        - ip route add default via 10.1.0.1

    # === 大阪拠点 ===
    router-osaka:
      kind: linux
      image: ghcr.io/vyos/vyos:current
      # 演習: スタティックルートを設定

    host-osaka:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 10.2.0.10/24 dev eth1
        - ip route add default via 10.2.0.1

  links:
    - endpoints: ["host-hq:eth1", "router-hq:eth1"]
    - endpoints: ["router-hq:eth2", "router-tokyo:eth1"]
    - endpoints: ["router-hq:eth3", "router-osaka:eth1"]
    - endpoints: ["router-tokyo:eth2", "host-tokyo:eth1"]
    - endpoints: ["router-osaka:eth2", "host-osaka:eth1"]
