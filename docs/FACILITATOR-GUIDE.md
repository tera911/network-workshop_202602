# 講師向け進行ガイド

勉強会を進行するためのガイドです。

---

## 全体構成

| Day | テーマ | 所要時間 | 難易度 |
|-----|--------|----------|--------|
| 1 | IPアドレスと疎通確認 | 2時間 | ★☆☆ |
| 2 | スタティックルーティング | 2.5時間 | ★★☆ |
| 3 | VLAN | 2時間 | ★★☆ |
| 4 | OSPF入門 | 3時間 | ★★★ |

---

## 事前準備チェックリスト

### 1週間前
- [ ] 参加者リストの確認
- [ ] 事前案内メールの送信（SETUP.md の「参加者への事前案内」を使用）
- [ ] 会場のネットワーク環境確認（プロキシ有無、ポート制限）
- [ ] **VyOS イメージのビルドと配布準備**（下記参照）

### 前日
- [ ] 自分の環境で全 Day を通しで動作確認
- [ ] プロジェクターでの表示確認（フォントサイズ、ターミナル背景色）
- [ ] 予備の USB メモリに教材 + VyOS イメージを入れておく

### 当日（開始1時間前）
- [ ] 会場のWiFi接続確認
- [ ] **イメージ配布用サーバーの起動**（必要な場合）
- [ ] 参加者の環境トラブルに備えて早めに開場
- [ ] ホワイトボード/マーカー準備（ネットワーク図を描く用）

---

## VyOS イメージの事前準備（重要）

VyOS 公式イメージが取得できない場合に備え、事前にビルドして配布準備をしてください。

### 1. イメージをビルド（初回のみ、30-60分）

```bash
cd ~/network-workshop-vyos
./scripts/build-vyos-docker.sh
```

### 2. 配布用ファイルを作成

```bash
./scripts/export-vyos-image.sh --compress
# → vyos-workshop.tar.gz（約 200MB）が作成される
```

### 3. 配布方法を選択

**方法A: USB メモリ配布**
- vyos-workshop.tar.gz を USB にコピー
- 参加者に回して docker load してもらう

**方法B: 会場で簡易サーバー**
```bash
# 講師のPCで実行
python3 -m http.server 8000

# 参加者に案内
# curl -O http://<講師IP>:8000/vyos-workshop.tar.gz
# gunzip -c vyos-workshop.tar.gz | docker load
```

**方法C: クラウドストレージ**
- Google Drive 等にアップロード
- 共有リンクを事前案内メールに記載

---

## Day 1: IPアドレスと疎通確認

### タイムテーブル（2時間）

| 時間 | 内容 | 形式 |
|------|------|------|
| 0:00-0:15 | オープニング、自己紹介、環境確認 | 全体 |
| 0:15-0:35 | IPアドレス/サブネットの解説 | 講義 |
| 0:35-0:50 | ラボ起動、VyOS基本操作のデモ | デモ |
| 0:50-1:00 | 休憩 | - |
| 1:00-1:15 | ping/traceroute の解説とデモ | 講義+デモ |
| 1:15-1:45 | 演習: ルーターを自分で設定 | ハンズオン |
| 1:45-2:00 | 振り返り、質疑応答 | 全体 |

### 進行のポイント

**オープニング（15分）**
- 参加者の環境確認を最優先
- `vhelp` でショートカットが使えるか確認
- 環境に問題がある人はサポート担当に任せて進行

**IPアドレス/サブネット解説（20分）**
- ホワイトボードに図を描きながら説明
- 「住所」の比喩を使う: IPアドレス = 住所、サブネット = 町内
- 実際の IP アドレス例を出す（会社のネットワーク、自宅のルーターなど）

**VyOS デモ（15分）**
- `configure` → `set` → `commit` → `save` の流れを見せる
- **Tab 補完を強調**（初学者は知らないことが多い）
- プロンプトの違い（`~$` vs `#`）を説明

**演習（30分）**
- 進捗を見ながら、早い人には追加課題を出す
- 詰まっている人には個別サポート
- **全員が ping を通せることをゴールに**

### よくある質問

**Q: なぜ IP アドレスは 4 つの数字なの？**
A: IPv4 は 32 ビットを 8 ビットずつ 4 つに分けて表記。歴史的経緯。IPv6 は 128 ビット。

**Q: サブネットマスク /24 と 255.255.255.0 は同じ？**
A: はい、同じ。/24 は CIDR 表記、255.255.255.0 はドット 10 進表記。

**Q: ping は通るのに traceroute がタイムアウトする**
A: ICMP のタイプが違う。中間ルーターが ICMP Time Exceeded を返さない場合がある。

---

## Day 2: スタティックルーティング

### タイムテーブル（2.5時間）

| 時間 | 内容 | 形式 |
|------|------|------|
| 0:00-0:10 | Day 1 の復習、今日の目標 | 全体 |
| 0:10-0:30 | ルーティングテーブルの解説 | 講義 |
| 0:30-0:50 | 3拠点構成のデモ | デモ |
| 0:50-1:00 | 休憩 | - |
| 1:00-1:20 | スタティックルートの設定方法 | 講義+デモ |
| 1:20-2:00 | 演習: 3拠点を接続 | ハンズオン |
| 2:00-2:15 | デフォルトルートの解説 | 講義 |
| 2:15-2:30 | 振り返り、質疑応答 | 全体 |

### 進行のポイント

**ルーティングテーブル解説（20分）**
- `show ip route` の出力を一行ずつ解説
- `C`（Connected）と `S`（Static）の違いを強調
- 「ルーターの地図」という比喩を使う

**3拠点デモ（20分）**
- ホワイトボードに構成図を描く
- traceroute で経路を見せる
- 「東京から大阪へは本社を経由する」という実感を持たせる

**演習（40分）**
- router-osaka の設定は自分で考えさせる
- **ヒント**: 東京の設定を参考に、IPアドレスを入れ替えるだけ
- 早い人にはデフォルトルートを試させる

### よくある質問

**Q: なぜ両方向に経路が必要？**
A: ネットワークは往復。行きの経路があっても、帰りの経路がないと通信できない。

**Q: デフォルトルートはいつ使う？**
A: 「それ以外」をまとめたい時。インターネットへの出口は通常デフォルトルート。

**Q: 経路が複数ある場合はどうなる？**
A: より詳細な経路（ロンゲストマッチ）が優先。/24 と /16 なら /24 を使う。

---

## Day 3: VLAN

### タイムテーブル（2時間）

| 時間 | 内容 | 形式 |
|------|------|------|
| 0:00-0:10 | Day 2 の復習、今日の目標 | 全体 |
| 0:10-0:30 | VLAN の概念と必要性 | 講義 |
| 0:30-0:50 | VLAN なし/あり の比較デモ | デモ |
| 0:50-1:00 | 休憩 | - |
| 1:00-1:20 | Linux Bridge の解説 | 講義 |
| 1:20-1:45 | 演習: VLAN を分離 | ハンズオン |
| 1:45-2:00 | タグVLANの紹介、振り返り | 講義 |

### 進行のポイント

**VLAN 解説（20分）**
- 「同じオフィスでも部署ごとにネットワークを分けたい」という実例
- セキュリティ面（経理部のPCに開発部からアクセスできない）を強調
- ブロードキャストの話は軽く触れる程度

**比較デモ（20分）**
- **Before**: VLAN なしで全員通信可能 → **After**: VLAN ありで分離
- 「同じスイッチなのに通信できない！」という驚きを演出
- `bridge link show` でポートの所属を見せる

**演習（25分）**
- Linux の `ip link` コマンドは馴染みがないので、コマンドは資料を見ながら
- 目的は「VLAN で分離できる」という体験

### よくある質問

**Q: 実際の会社ではどう設定する？**
A: 管理画面やCLIでスイッチのポートに VLAN ID を設定。やることは同じ。

**Q: VLAN 間で通信したい場合は？**
A: ルーター（または L3 スイッチ）を使う。Day 4 の OSPF 後に余裕があれば紹介。

**Q: VLAN ID は何番でもいい？**
A: 1-4094 の範囲。1 はデフォルト VLAN、4095 は予約。

---

## Day 4: OSPF 入門

### タイムテーブル（3時間）

| 時間 | 内容 | 形式 |
|------|------|------|
| 0:00-0:15 | これまでの復習、動的ルーティングの必要性 | 講義 |
| 0:15-0:40 | OSPF の基本概念（Neighbor, Area, LSA） | 講義 |
| 0:40-1:00 | OSPF の動作デモ | デモ |
| 1:00-1:15 | 休憩 | - |
| 1:15-1:45 | 演習: OSPF を設定 | ハンズオン |
| 1:45-2:15 | 障害時の自動迂回デモ | デモ+ハンズオン |
| 2:15-2:30 | 休憩 | - |
| 2:30-2:50 | OSPF vs スタティック まとめ | 講義 |
| 2:50-3:00 | 全体振り返り、次のステップ | 全体 |

### 進行のポイント

**動的ルーティングの必要性（15分）**
- Day 2 のスタティックルートを思い出させる
- 「拠点が 10 個になったら？」「リンクが切れたら？」
- スタティックの限界を実感させてから OSPF へ

**OSPF 概念（25分）**
- Neighbor: 「隣人と挨拶（Hello）して仲良くなる」
- Area: 「地区ごとに情報をまとめる」
- LSA: 「回覧板でネットワーク情報を共有」
- **深入りしすぎない**: DR/BDR、LSA タイプは触れなくてOK

**自動迂回デモ（30分）**
- **ここが Day 4 のハイライト**
- 事前に traceroute で直接経路を見せる
- `set interfaces ethernet eth3 disable` でリンクを切断
- 「数秒で経路が切り替わる！」を体感させる
- 参加者にも自分の環境で試させる

### よくある質問

**Q: OSPF と BGP の違いは？**
A: OSPF は組織内（IGP）、BGP は組織間（EGP）。インターネットは BGP で繋がっている。

**Q: Area はなぜ必要？**
A: 大規模ネットワークでは LSA が多すぎる。Area で分けて効率化。

**Q: Router ID は何に使う？**
A: OSPF 内でルーターを識別。通常は最大の Loopback IP か、手動設定。

**Q: なぜ自動で経路が変わる？**
A: Hello パケットが途絶えると Neighbor Down を検知。SPF 再計算で新経路を選択。

---

## トラブル対応

### 参加者の環境が動かない

1. まず落ち着いて状況確認
2. TROUBLESHOOTING.md を参照
3. 他の参加者とペアを組ませて続行させる
4. 休憩中に個別対応

### 時間が足りない

- 演習を短縮し、デモで見せる形式に切り替え
- 追加課題はスキップ
- 「復習用」として資料を持ち帰らせる

### 時間が余る

- 追加課題を出す
- 参加者同士でトラブルシューティング体験
- 「なぜそうなるか」を深掘りする議論

---

## 追加課題（早い人向け）

### Day 1
- /30 サブネットで Point-to-Point 接続を作る
- IPv6 アドレスを設定してみる

### Day 2
- 4 拠点構成に拡張する
- 非対称ルーティングを作ってみる（行きと帰りで経路が違う）

### Day 3
- Inter-VLAN ルーティングを設定する
- トランクポートを使って複数 VLAN を通す

### Day 4
- OSPF コストを変更して経路を制御する
- 複数 Area 構成にする（Area 0 + Area 1）

---

## クロージング

- 参加者へのアンケート依頼
- 次回勉強会の案内（あれば）
- 学習リソースの紹介
  - VyOS Documentation: https://docs.vyos.io/
  - ネットワークエンジニアとして: https://www.infraexpert.com/
  - Packet Tracer（Cisco の無料シミュレータ）
